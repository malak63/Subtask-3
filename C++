int speedForward = 120;
int speedTurn = 60;

void setup() {
  pinMode(10, OUTPUT); // Left PWM
  pinMode(11, OUTPUT); // Right PWM
  pinMode(9, OUTPUT);  // Left Dir1
  pinMode(8, OUTPUT);  // Left Dir2
  pinMode(7, OUTPUT);  // Right Dir1
  pinMode(6, OUTPUT);  // Right Dir2
  pinMode(2, INPUT);   // Left sensor
  pinMode(3, INPUT);   // Right sensor
}

void loop() {
  // Wait for start line
  while (digitalRead(2) == HIGH || digitalRead(3) == HIGH) {
    // stay here until both sensors see line
  }

  // Line following until finish line
  while (true) {
    int leftSensor = digitalRead(2);
    int rightSensor = digitalRead(3);

    // Stop at finish line
    if (leftSensor == HIGH && rightSensor == HIGH) {
      softStop();
      break;
    }

    if (leftSensor == LOW && rightSensor == LOW) {
      forward();
    } else if (leftSensor == LOW && rightSensor == HIGH) {
      turnLeft();
    } else if (leftSensor == HIGH && rightSensor == LOW) {
      turnRight();
    }
  }
}

void forward() {
  digitalWrite(9, HIGH);
  digitalWrite(8, LOW);
  analogWrite(10, speedForward);

  digitalWrite(7, HIGH);
  digitalWrite(6, LOW);
  analogWrite(11, speedForward);
}

void turnLeft() {
  digitalWrite(9, LOW);
  digitalWrite(8, HIGH);
  analogWrite(10, speedTurn);

  digitalWrite(7, HIGH);
  digitalWrite(6, LOW);
  analogWrite(11, speedForward);
}

void turnRight() {
  digitalWrite(9, HIGH);
  digitalWrite(8, LOW);
  analogWrite(10, speedForward);

  digitalWrite(7, LOW);
  digitalWrite(6, HIGH);
  analogWrite(11, speedTurn);
}

void softStop() {
  analogWrite(10, 0);
  analogWrite(11, 0);
  digitalWrite(9, LOW);
  digitalWrite(8, LOW);
  digitalWrite(7, LOW);
  digitalWrite(6,Â LOW);
}
